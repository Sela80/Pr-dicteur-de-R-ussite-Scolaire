{% extends "base.html" %}

{% block title %}R√©sultat - Pr√©dicteur{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-12">
    <div class="max-w-4xl mx-auto">
        <!-- Result Card -->
        <div class="text-center mb-8 fade-in">
            <h2 class="text-3xl md:text-4xl font-bold text-gray-800 mb-3">üéØ R√©sultat de votre pr√©diction</h2>
            <p class="text-gray-600">Bas√© sur l'analyse de vos donn√©es par notre IA</p>
        </div>
        
        <div class="bg-white rounded-2xl card-shadow p-10 text-center slide-up">
            <!-- Score Circle Animation -->
            <div class="relative inline-block mb-6">
                <svg class="transform -rotate-90" width="200" height="200">
                    <circle cx="100" cy="100" r="90" stroke="#e5e7eb" stroke-width="12" fill="none"></circle>
                    <circle id="progressCircle" cx="100" cy="100" r="90" 
                            stroke="{% if score >= 80 %}#10b981{% elif score >= 60 %}#f59e0b{% else %}#ef4444{% endif %}" 
                            stroke-width="12" fill="none"
                            stroke-dasharray="565.48" 
                            stroke-dashoffset="565.48"
                            stroke-linecap="round"
                            style="transition: stroke-dashoffset 2s ease-in-out;">
                    </circle>
                </svg>
                <div class="absolute inset-0 flex items-center justify-center">
                    <div>
                        <div id="scoreNumber" class="text-6xl font-bold 
                            {% if score >= 80 %}text-green-500
                            {% elif score >= 60 %}text-yellow-500
                            {% else %}text-red-500{% endif %}">0</div>
                        <div class="text-gray-500 text-sm font-medium">/ 100</div>
                    </div>
                </div>
            </div>
            
            <p class="text-xl text-gray-600 mb-6">Score pr√©dit √† l'examen</p>
            
            <!-- Status Badge -->
            <div class="inline-block px-6 py-3 rounded-full mb-8
                {% if score >= 80 %}bg-green-100 text-green-700
                {% elif score >= 60 %}bg-yellow-100 text-yellow-700
                {% else %}bg-red-100 text-red-700{% endif %}">
                {% if score >= 80 %}
                    <span class="text-2xl">üéâ</span>
                    <span class="font-bold ml-2">Excellent niveau !</span>
                {% elif score >= 60 %}
                    <span class="text-2xl">üëç</span>
                    <span class="font-bold ml-2">Bon niveau, continuez !</span>
                {% else %}
                    <span class="text-2xl">üìà</span>
                    <span class="font-bold ml-2">Potentiel d'am√©lioration</span>
                {% endif %}
            </div>
            
            <!-- Recommendations -->
            <div class="bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl p-6 mb-8 text-left">
                <h3 class="font-bold text-lg text-gray-800 mb-3">üí° Recommandations</h3>
                <ul class="space-y-2 text-gray-700">
                    {% if score >= 80 %}
                        <li class="flex items-start">
                            <span class="text-green-500 mr-2">‚úî</span>
                            <span>Maintenez vos excellentes habitudes d'√©tude</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-green-500 mr-2">‚úî</span>
                            <span>Continuez √† vous fixer des objectifs ambitieux</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-green-500 mr-2">‚úî</span>
                            <span>Partagez vos m√©thodes avec vos camarades</span>
                        </li>
                    {% elif score >= 60 %}
                        <li class="flex items-start">
                            <span class="text-yellow-500 mr-2">‚û§</span>
                            <span>Augmentez progressivement vos heures d'√©tude</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-yellow-500 mr-2">‚û§</span>
                            <span>Am√©liorez votre assiduit√© et votre ponctualit√©</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-yellow-500 mr-2">‚û§</span>
                            <span>Optimisez vos heures de sommeil (7-9h par nuit)</span>
                        </li>
                    {% else %}
                        <li class="flex items-start">
                            <span class="text-red-500 mr-2">‚ö†</span>
                            <span>Augmentez significativement vos heures d'√©tude</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-red-500 mr-2">‚ö†</span>
                            <span>Demandez du soutien (tutorat, aide aux devoirs)</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-red-500 mr-2">‚ö†</span>
                            <span>Travaillez sur votre motivation et organisation</span>
                        </li>
                    {% endif %}
                </ul>
            </div>

            <!-- Action Buttons -->
            <div class="flex flex-col sm:flex-row gap-4 justify-center">
                <a href="{{ url_for('form') }}" class="btn-primary inline-block bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-semibold py-3 px-8 rounded-xl transition transform hover:scale-105">
                    üîÑ Nouvelle pr√©diction
                </a>
                <a href="{{ url_for('index') }}" class="inline-block bg-gray-100 hover:bg-gray-200 text-gray-700 font-semibold py-3 px-8 rounded-xl transition">
                    üè† Retour √† l'accueil
                </a>
            </div>
        </div>
        
        <!-- Info Box -->
        <div class="mt-8 bg-blue-50 border-l-4 border-blue-500 p-6 rounded-lg slide-up" style="animation-delay: 0.3s">
            <p class="text-gray-700">
                <strong class="text-blue-700">üìå Note :</strong> Cette pr√©diction est bas√©e sur un mod√®le d'apprentissage automatique. 
                Elle sert d'indication pour identifier les domaines d'am√©lioration, mais ne garantit pas votre r√©sultat final.
            </p>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    // Animate score number
    const targetScore = {{ score }};
    const scoreElement = document.getElementById('scoreNumber');
    const progressCircle = document.getElementById('progressCircle');
    const circumference = 565.48;
    
    let currentScore = 0;
    const duration = 2000; // 2 seconds
    const increment = targetScore / (duration / 16); // 60fps
    
    function animateScore() {
        if (currentScore < targetScore) {
            currentScore += increment;
            if (currentScore > targetScore) currentScore = targetScore;
            scoreElement.textContent = Math.round(currentScore);
            requestAnimationFrame(animateScore);
        }
    }
    
    // Animate circle
    setTimeout(() => {
        const offset = circumference - (targetScore / 100) * circumference;
        progressCircle.style.strokeDashoffset = offset;
        animateScore();
    }, 300);
    
    // Add confetti effect for excellent scores
    {% if score >= 80 %}
    function createConfetti() {
        const colors = ['#10b981', '#3b82f6', '#8b5cf6', '#f59e0b', '#ef4444'];
        for (let i = 0; i < 50; i++) {
            setTimeout(() => {
                const confetti = document.createElement('div');
                confetti.style.position = 'fixed';
                confetti.style.width = '10px';
                confetti.style.height = '10px';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.left = Math.random() * window.innerWidth + 'px';
                confetti.style.top = '-10px';
                confetti.style.borderRadius = '50%';
                confetti.style.pointerEvents = 'none';
                confetti.style.zIndex = '9999';
                document.body.appendChild(confetti);
                
                const animation = confetti.animate([
                    { transform: 'translateY(0) rotate(0deg)', opacity: 1 },
                    { transform: `translateY(${window.innerHeight}px) rotate(${Math.random() * 360}deg)`, opacity: 0 }
                ], {
                    duration: 3000 + Math.random() * 2000,
                    easing: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)'
                });
                
                animation.onfinish = () => confetti.remove();
            }, i * 30);
        }
    }
    
    setTimeout(createConfetti, 500);
    {% endif %}
</script>
{% endblock %}
